[["index.html", "Finding Expression Data with GEOmetadb Welcome", " Finding Expression Data with GEOmetadb Ruth Isserlin 2026-02-04 Welcome This book is a tutorial-style rewrite of a lecture on where to find expression data and how to mine GEO metadata with the GEOmetadb package. It is designed for fourth-year bioinformatics students and focuses on reproducible code that you can run as-is. If you’re new to bookdown, install it with: install.packages(&quot;bookdown&quot;) Then build this book by running in R: bookdown::render_book(&quot;.&quot;) "],["overview.html", "Chapter 1 Overview", " Chapter 1 Overview Where can I find expression data? Tools for mining the data — GEOmetadb What GEO data types exist (GSE/GSM/GPL/GDS)? How to shortlist a dataset of interest The main public repository we’ll use is the Gene Expression Omnibus (GEO). Visit: https://www.ncbi.nlm.nih.gov/geo/. "],["geo-datatypes.html", "Chapter 2 GEO Datatypes", " Chapter 2 GEO Datatypes GEO organizes data into several related entities: GSE — Series: links related samples and describes the study; may include archives of raw/processed files. GSM — Sample: per‑sample description and data; each GSM belongs to exactly one platform (GPL). GPL — Platform: array/sequencer description; many GSMs can map to a single GPL. GDS — Dataset: curated collections of comparable samples on the same platform with uniform processing. See the GEO overview: https://www.ncbi.nlm.nih.gov/geo/info/overview.html "],["setting-up-geometadb.html", "Chapter 3 Setting up GEOmetadb 3.1 Install packages 3.2 Get the SQLite database 3.3 Connect to the database 3.4 Explore tables and fields", " Chapter 3 Setting up GEOmetadb GEOmetadb provides a SQLite mirror of GEO metadata that you can query from R. It mirrors GEO as-is (no curation). Download the current SQLite file once and reuse it. 3.1 Install packages if (!requireNamespace(&quot;BiocManager&quot;, quietly = TRUE)) install.packages(&quot;BiocManager&quot;) if (!requireNamespace(&quot;GEOmetadb&quot;, quietly = TRUE)) BiocManager::install(&quot;GEOmetadb&quot;) if (!requireNamespace(&quot;DBI&quot;, quietly = TRUE)) install.packages(&quot;DBI&quot;) if (!requireNamespace(&quot;RSQLite&quot;, quietly = TRUE)) install.packages(&quot;RSQLite&quot;) if (!requireNamespace(&quot;dplyr&quot;, quietly = TRUE)) install.packages(&quot;dplyr&quot;) if (!requireNamespace(&quot;ggplot2&quot;, quietly = TRUE)) install.packages(&quot;ggplot2&quot;) 3.2 Get the SQLite database library(GEOmetadb) ## Loading required package: R.utils ## Loading required package: R.oo ## Loading required package: R.methodsS3 ## R.methodsS3 v1.8.2 (2022-06-13 22:00:14 UTC) successfully loaded. See ?R.methodsS3 for help. ## R.oo v1.27.1 (2025-05-02 21:00:05 UTC) successfully loaded. See ?R.oo for help. ## ## Attaching package: &#39;R.oo&#39; ## The following object is masked from &#39;package:R.methodsS3&#39;: ## ## throw ## The following objects are masked from &#39;package:methods&#39;: ## ## getClasses, getMethods ## The following objects are masked from &#39;package:base&#39;: ## ## attach, detach, load, save ## R.utils v2.13.0 (2025-02-24 21:20:02 UTC) successfully loaded. See ?R.utils for help. ## ## Attaching package: &#39;R.utils&#39; ## The following object is masked from &#39;package:utils&#39;: ## ## timestamp ## The following objects are masked from &#39;package:base&#39;: ## ## cat, commandArgs, getOption, isOpen, nullfile, ## parse, use, warnings ## Loading required package: RSQLite if (!file.exists(&#39;GEOmetadb.sqlite&#39;)) getSQLiteFile() ## Unzipping... ## Metadata associate with downloaded file: ## name value ## 1 schema version 1.0 ## 2 creation timestamp 2024-03-06 03:05:59 ## [1] &quot;/home/rstudio/Zhanyan_Guo/in_class_exercises/using_geometadb/GEOmetadb.sqlite&quot; file.info(&#39;GEOmetadb.sqlite&#39;) ## size isdir mode mtime ## GEOmetadb.sqlite 19576775680 FALSE 644 2026-02-04 03:09:06 ## ctime atime ## GEOmetadb.sqlite 2026-02-04 03:09:06 2026-02-04 03:09:07 ## uid gid uname grname ## GEOmetadb.sqlite 1000 1000 rstudio rstudio 3.3 Connect to the database library(DBI) library(RSQLite) con &lt;- dbConnect(SQLite(), &#39;GEOmetadb.sqlite&#39;) 3.4 Explore tables and fields dbListTables(con) ## [1] &quot;gds&quot; &quot;gds_subset&quot; ## [3] &quot;geoConvert&quot; &quot;geodb_column_desc&quot; ## [5] &quot;gpl&quot; &quot;gse&quot; ## [7] &quot;gse_gpl&quot; &quot;gse_gsm&quot; ## [9] &quot;gsm&quot; &quot;metaInfo&quot; ## [11] &quot;sMatrix&quot; dbListFields(con, &#39;gse&#39;) ## [1] &quot;ID&quot; &quot;title&quot; ## [3] &quot;gse&quot; &quot;status&quot; ## [5] &quot;submission_date&quot; &quot;last_update_date&quot; ## [7] &quot;pubmed_id&quot; &quot;summary&quot; ## [9] &quot;type&quot; &quot;contributor&quot; ## [11] &quot;web_link&quot; &quot;overall_design&quot; ## [13] &quot;repeats&quot; &quot;repeats_sample_list&quot; ## [15] &quot;variable&quot; &quot;variable_description&quot; ## [17] &quot;contact&quot; &quot;supplementary_file&quot; "],["exploring-platforms-gpl.html", "Chapter 4 Exploring Platforms (GPL) 4.1 Restrict to human", " Chapter 4 Exploring Platforms (GPL) How many platforms exist, and what technologies do they use? num_platforms &lt;- dbGetQuery(con, &#39;select count(*) as n from gpl&#39;) num_platforms ## n ## 1 25880 uniq_tech &lt;- dbGetQuery(con, &#39;select distinct technology from gpl&#39;) NROW(uniq_tech) ## [1] 18 num_uniq_tech &lt;- dbGetQuery(con, &#39;select technology, count(*) as Num_Platforms from gpl group by technology&#39;) # Quick plot library(ggplot2) plot_df &lt;- subset(num_uniq_tech, !is.na(technology)) ggplot(plot_df, aes(x = technology, y = Num_Platforms)) + geom_col() + coord_flip() 4.1 Restrict to human num_uniq_tech_human &lt;- dbGetQuery(con, &quot;select technology, count(*) as Num_Platforms from gpl where organism = &#39;Homo sapiens&#39; group by technology order by Num_Platforms desc&quot;) num_uniq_tech_contain_human &lt;- dbGetQuery(con, &quot;select technology, count(*) as Num_Platforms from gpl where organism like &#39;%Homo sapiens%&#39; group by technology order by Num_Platforms desc&quot;) library(dplyr) ## ## Attaching package: &#39;dplyr&#39; ## The following objects are masked from &#39;package:stats&#39;: ## ## filter, lag ## The following objects are masked from &#39;package:base&#39;: ## ## intersect, setdiff, setequal, union uniq_tech_all &lt;- bind_rows( transform(num_uniq_tech_human, type = &#39;human only&#39;), transform(num_uniq_tech_contain_human, type = &#39;contains human&#39;), transform(num_uniq_tech, type = &#39;All species&#39;) ) ggplot(uniq_tech_all, aes(technology, Num_Platforms, fill = type)) + geom_col(position = &#39;dodge&#39;) + coord_flip() + theme(legend.position = &#39;bottom&#39;) + ggtitle(&#39;Platforms that contain human vs human only&#39;) "],["finding-datasets-of-interest.html", "Chapter 5 Finding Datasets of Interest 5.1 RNA-seq series by platform technology 5.2 Add organism and recency filters 5.3 Add a topic keyword (e.g., ovarian) 5.4 Heuristic: require a counts-like supplementary file 5.5 Require a minimum number of samples per series", " Chapter 5 Finding Datasets of Interest Goal: RNA-seq, human, recent (last ~3 years), and with sufficient samples. 5.1 RNA-seq series by platform technology sql &lt;- paste( &quot;SELECT DISTINCT gse.title, gse.gse, gpl.title&quot;, &quot;FROM gse JOIN gse_gpl ON gse_gpl.gse = gse.gse&quot;, &quot;JOIN gpl ON gse_gpl.gpl = gpl.gpl&quot;, &quot;WHERE gpl.technology = &#39;high-throughput sequencing&#39;&quot; ) rs &lt;- dbGetQuery(con, sql) dim(rs) ## [1] 61489 3 5.2 Add organism and recency filters sql &lt;- paste( &quot;SELECT DISTINCT gse.title, gse.gse, gpl.title, gse.submission_date&quot;, &quot;FROM gse JOIN gse_gpl ON gse_gpl.gse = gse.gse&quot;, &quot;JOIN gpl ON gse_gpl.gpl = gpl.gpl&quot;, &quot;WHERE gse.submission_date &gt; &#39;2022-01-01&#39; AND&quot;, &quot;gpl.organism LIKE &#39;%Homo sapiens%&#39; AND&quot;, &quot;gpl.technology LIKE &#39;%high-throughput seq%&#39;&quot; ) rs &lt;- dbGetQuery(con, sql) dim(rs) ## [1] 3202 4 5.3 Add a topic keyword (e.g., ovarian) sql &lt;- paste( &quot;SELECT DISTINCT gse.title, gse.gse, gpl.title, gse.submission_date&quot;, &quot;FROM gse JOIN gse_gpl ON gse_gpl.gse = gse.gse&quot;, &quot;JOIN gpl ON gse_gpl.gpl = gpl.gpl&quot;, &quot;WHERE gse.submission_date &gt; &#39;2022-01-01&#39; AND&quot;, &quot;gse.title LIKE &#39;%ovarian%&#39; AND&quot;, &quot;gpl.organism LIKE &#39;%Homo sapiens%&#39; AND&quot;, &quot;gpl.technology LIKE &#39;%high-throughput seq%&#39;&quot; ) rs &lt;- dbGetQuery(con, sql) dim(rs) ## [1] 27 4 head(rs[, c(&#39;gse&#39;,&#39;title&#39;)]) ## gse ## 1 GSE192898 ## 2 GSE197320 ## 3 GSE200852 ## 4 GSE201223 ## 5 GSE201337 ## 6 GSE201525 ## title ## 1 Single cell 5&#39; RNA sequencing of 9 Korean ovarian cancer patients ## 2 Therapeutic Targeting of Ovarian Cancer Stem Cells Using Estrogen Receptor Beta Agonist ## 3 The microRNA profiles of ovarian clear cell carcinoma ## 4 Zinc increases hormone receptor expression in human ovarian granulosa cells and gene profiling ## 5 Investigation of the anti-tumour properties of interferon epsilon in high grade serous ovarian cancer in vivo. ## 6 Investigation of the anti-tumour properties of interferon epsilon in high grade serous ovarian cancer 5.4 Heuristic: require a counts-like supplementary file sql &lt;- paste( &quot;SELECT DISTINCT gse.title, gse.gse, gpl.title, gse.submission_date, gse.supplementary_file&quot;, &quot;FROM gse JOIN gse_gpl ON gse_gpl.gse = gse.gse&quot;, &quot;JOIN gpl ON gse_gpl.gpl = gpl.gpl&quot;, &quot;WHERE gse.submission_date &gt; &#39;2022-01-01&#39; AND&quot;, &quot;gse.title LIKE &#39;%ovarian%&#39; AND&quot;, &quot;gpl.organism LIKE &#39;%Homo sapiens%&#39; AND&quot;, &quot;gpl.technology LIKE &#39;%high-throughput sequencing%&#39;&quot;, &quot;ORDER BY gse.submission_date DESC&quot; ) rs &lt;- dbGetQuery(con, sql) counts_files &lt;- rs$supplementary_file[grep(&quot;count|cnt&quot;, rs$supplementary_file, ignore.case = TRUE)] series_of_interest &lt;- rs$gse[grep(&quot;count|cnt&quot;, rs$supplementary_file, ignore.case = TRUE)] # Preview filenames shortened &lt;- unlist(lapply(counts_files, function(x){ x &lt;- unlist(strsplit(x, &quot;;&quot;)) x &lt;- x[grep(&quot;count|cnt|txt|csv|xlsx&quot;, x, ignore.case = TRUE)] tail(unlist(strsplit(x, &quot;/&quot;)), n = 1) })) head(shortened, 10) ## [1] &quot;GSE252379_samples_attr.txt.gz&quot; ## [2] &quot;GSE235755_raw_counts_batch_adjusted.txt.gz&quot; ## [3] &quot;GSE231560_OV90_TPM1.counts.txt.gz&quot; ## [4] &quot;GSE227276_MTF_KD_KURAMOCHI_FT246.sorted.htseq-count.TPM.txt.gz&quot; ## [5] &quot;GSE223011_Nijhuis_KURAMOCHI_VC_INDISULAM_humanCounts.tsv.xlsx&quot; ## [6] &quot;GSE222982_supplementary_file_estimated_raw_counts_for_all_samples.txt.gz&quot; ## [7] &quot;GSE212702_RNA_seq_count_table.xlsx&quot; ## [8] &quot;GSE207094_raw_counts.txt.gz&quot; ## [9] &quot;GSE202601_human_ovary_snRNA-seq_metadata.txt.gz&quot; ## [10] &quot;GSE201337_PDX_IFN_UMI_counts.csv.gz&quot; 5.5 Require a minimum number of samples per series num_series &lt;- dbGetQuery(con, paste( &quot;select * from gsm where series_id in (&#39;&quot;, paste(series_of_interest, collapse = &quot;&#39;,&#39;&quot;), &quot;&#39;)&quot;, sep = &quot;&quot;)) gse.count &lt;- as.data.frame(table(num_series$series_id)) subset(gse.count, Freq &gt; 6) ## Var1 Freq ## 1 GSE202601 16 ## 2 GSE207094 45 ## 3 GSE212702 84 ## 4 GSE222982 10 ## 6 GSE227276 30 ## 7 GSE231560 15 ## 8 GSE235755 11 "],["exercises-inspect-specific-geo-series.html", "Chapter 6 Exercises: Inspect Specific GEO Series", " Chapter 6 Exercises: Inspect Specific GEO Series In this exercise, you’ll retrieve metadata for the following GEO Series and answer: GSE IDs: “GSE201427”,“GSE166530”,“GSE162183”,“GSE186458” Questions per GSE What type of data is it? Describe it. (platform technology; e.g., high-throughput sequencing, array) What disease or model is it using? (infer from series title/summary/platform organism) How many samples are there? What type of data is associated with the record? How many control and how many disease? **Can you find out any information about the GEO dataset - GSE264108. Why or Why not? Hint: Sample labels are not standardized. Use robust keyword detection (e.g., control|normal|healthy|wild[- ]?type vs. tumou?r|cancer|patient|disease|mutant|treated). Inspect a few GSM rows if the automatic inference is uncertain. "],["next-week-next-steps.html", "Chapter 7 Next week / Next steps", " Chapter 7 Next week / Next steps Download one candidate series and its supplementary counts Document everything (session info, package versions) sessionInfo() ## R version 4.5.2 (2025-10-31) ## Platform: x86_64-pc-linux-gnu ## Running under: Ubuntu 24.04.3 LTS ## ## Matrix products: default ## BLAS: /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so; LAPACK version 3.12.0 ## ## locale: ## [1] LC_CTYPE=en_US.UTF-8 LC_NUMERIC=C ## [3] LC_TIME=en_US.UTF-8 LC_COLLATE=en_US.UTF-8 ## [5] LC_MONETARY=en_US.UTF-8 LC_MESSAGES=en_US.UTF-8 ## [7] LC_PAPER=en_US.UTF-8 LC_NAME=C ## [9] LC_ADDRESS=C LC_TELEPHONE=C ## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C ## ## time zone: Etc/UTC ## tzcode source: system (glibc) ## ## attached base packages: ## [1] stats graphics grDevices utils datasets ## [6] methods base ## ## other attached packages: ## [1] dplyr_1.1.4 ggplot2_4.0.1 DBI_1.2.3 ## [4] GEOmetadb_1.70.0 RSQLite_2.4.5 R.utils_2.13.0 ## [7] R.oo_1.27.1 R.methodsS3_1.8.2 ## ## loaded via a namespace (and not attached): ## [1] bit_4.6.0 gtable_0.3.6 ## [3] jsonlite_2.0.0 compiler_4.5.2 ## [5] BiocManager_1.30.27 tidyselect_1.2.1 ## [7] blob_1.2.4 jquerylib_0.1.4 ## [9] scales_1.4.0 yaml_2.3.11 ## [11] fastmap_1.2.0 R6_2.6.1 ## [13] labeling_0.4.3 generics_0.1.4 ## [15] knitr_1.51 tibble_3.3.0 ## [17] bookdown_0.46 RColorBrewer_1.1-3 ## [19] bslib_0.9.0 pillar_1.11.1 ## [21] rlang_1.1.6 cachem_1.1.0 ## [23] xfun_0.55 S7_0.2.1 ## [25] sass_0.4.10 bit64_4.6.0-1 ## [27] otel_0.2.0 memoise_2.0.1 ## [29] cli_3.6.5 withr_3.0.2 ## [31] magrittr_2.0.4 digest_0.6.39 ## [33] grid_4.5.2 rstudioapi_0.17.1 ## [35] lifecycle_1.0.4 vctrs_0.6.5 ## [37] evaluate_1.0.5 glue_1.8.0 ## [39] farver_2.1.2 rmarkdown_2.30 ## [41] tools_4.5.2 pkgconfig_2.0.3 ## [43] htmltools_0.5.9 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
